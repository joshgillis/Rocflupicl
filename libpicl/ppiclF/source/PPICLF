! number of timesteps kept in history kernels
! maximum number of triangular patch boundaries
! y, y1, ydot, ydotc: 12
! rprop: 54
! probably delete below ones later; using them for plotting
! rprop4: PPICLF_LRP4 - Reynolds Subgrid Stress Components
! rprop5: PPICLF_LRP5 - Storing Force Models
! map: 19
!--- x,y,z Forces to Rocflu
!---
!--- Add comment about these terms
!--- Reynolds Subgrid Stress Tensor
c Computational particles
      REAL*8 PPICLF_Y (12 ,20000) ! Solution
     > ,PPICLF_YDOT (12 ,20000) ! Total solution RHS
     > ,PPICLF_YDOTC (12 ,20000) ! Coupled solution RHS
     > ,PPICLF_RPROP (54 ,20000) ! Real particle properties
     > ,PPICLF_RPROP2(4,20000) ! Secondary real particle properties
     > ,PPICLF_RPROP3(6*5,20000) ! Third real particle properties
     > ,PPICLF_RPROP4(9,20000) ! Fourth real particle properties
     > ,PPICLF_RPROP5(19,20000) ! Fifth real particle properties
      COMMON /PPICLF_SLN_CURRENT_R/ PPICLF_Y
     > ,PPICLF_YDOT
     > ,PPICLF_YDOTC
     > ,PPICLF_RPROP
     > ,PPICLF_RPROP2
     > ,PPICLF_RPROP3
     > ,PPICLF_RPROP4
     > ,PPICLF_RPROP5
      INTEGER*4 PPICLF_IPROP(11,20000) ! Integer particle properties
      COMMON /PPICLF_SLN_CURRENT_I/ PPICLF_IPROP
      COMMON /PPICLF_SLN_CURRENT_N/ PPICLF_NPART
      INTEGER*4 PPICLF_NPART
c Previous time step solutions, may grow later
      REAL*8 PPICLF_Y1(12*20000)
      COMMON /PPICLF_SLN_PREVIOUS_R/ PPICLF_Y1
c Previous time step solutions, may grow later
      REAL*8 PPICLF_TIMEBH(5)
      REAL*8 PPICLF_DRUDTPLAG(3,5,20000)
      REAL*8 PPICLF_DRUDTMIXT(3,5,20000)
      COMMON /PPICLF_SLN_UNSTEADY/ PPICLF_TIMEBH
     > ,PPICLF_DRUDTPLAG
     > ,PPICLF_DRUDTMIXT
! number of timesteps kept in history kernels
! maximum number of triangular patch boundaries
! y, y1, ydot, ydotc: 12
! rprop: 54
! probably delete below ones later; using them for plotting
! rprop4: PPICLF_LRP4 - Reynolds Subgrid Stress Components
! rprop5: PPICLF_LRP5 - Storing Force Models
! map: 19
!--- x,y,z Forces to Rocflu
!---
!--- Add comment about these terms
!--- Reynolds Subgrid Stress Tensor
C Grid
      REAL*8 PPICLF_XDRANGE(2,3), PPICLF_XERANGE(2,3,75000)
      COMMON /PPICLF_GRID_RANGE_R/ PPICLF_XDRANGE, PPICLF_XERANGE
      COMMON /PPICLF_GRID_FLD_R/ PPICLF_PRO_FLD, PPICLF_INT_FLD
     > ,PPICLF_INT_FLDU ,PPICLF_PRO_FLDB
     > ,PPICLF_XM1B ,PPICLF_XM1BS, PPICLF_XM1BI
     > ,PPICLF_XM1BG, PPICLF_INT_FLDG
      REAL*8 PPICLF_PRO_FLD (2,2,2,75000
     > ,19),
     > PPICLF_INT_FLDU(2,2,2
     > ,75000,30),
     > PPICLF_INT_FLD (2,2,2
     > ,30,75000),
     > PPICLF_INT_FLDG(2,2,2
     > ,30,75000),
     > PPICLF_PRO_FLDB(2,2,2
     > ,19,75000),
     > PPICLF_XM1B (2,2,2,3
     > ,75000),
     > PPICLF_XM1BS (2,2,2
     > ,3,75000),
     > PPICLF_XM1BI (2,2,2
     > ,75000,3),
     > PPICLF_XM1BG (2,2,2
     > ,3,75000)
      COMMON /PPICLF_GRID_BIN_MAP_I/ PPICLF_ER_MAP,PPICLF_ER_MAPC
     > ,PPICLF_ER_MAPS,PPICLF_ER_MAPG
     > ,PPICLF_EL_MAP,PPICLF_ER_MAPGS
     > ,PPICLF_ER_MAPGC
     > ,PPICLF_MODGP,PPICLF_NELTB,PPICLF_NELTBB
     > ,PPICLF_NELTBBB,PPICLF_NELTBG
     > ,PPICLF_NELTBBG
      INTEGER*4 PPICLF_ER_MAP (6,75000),
     > PPICLF_ER_MAPC(6,75000),
     > PPICLF_ER_MAPS(6,75000),
     > PPICLF_ER_MAPG(6,75000),
     > PPICLF_ER_MAPGS(6,75000),
     > PPICLF_ER_MAPGC(6,75000),
     > PPICLF_MODGP (2,2,2
     > ,75000,4),
     > PPICLF_EL_MAP (8,75000), PPICLF_NELTB,PPICLF_NELTBB,
     > PPICLF_NELTBBB,PPICLF_NELTBG, PPICLF_NELTBBG
      INTEGER*4 PPICLF_NEE
      COMMON /PPICLF_GRID_ORIG_CELL_N/ PPICLF_NEE
      INTEGER*4 PPICLF_INT_ICNT, PPICLF_INT_MAP(30)
      COMMON /PPICLF_INTERP_I/ PPICLF_INT_ICNT, PPICLF_INT_MAP
! number of timesteps kept in history kernels
! maximum number of triangular patch boundaries
! y, y1, ydot, ydotc: 12
! rprop: 54
! probably delete below ones later; using them for plotting
! rprop4: PPICLF_LRP4 - Reynolds Subgrid Stress Components
! rprop5: PPICLF_LRP5 - Storing Force Models
! map: 19
!--- x,y,z Forces to Rocflu
!---
!--- Add comment about these terms
!--- Reynolds Subgrid Stress Tensor
c Particle options
      LOGICAL PPICLF_RESTART, PPICLF_OVERLAP, PPICLF_LCOMM
     > ,PPICLF_LINIT, PPICLF_LFILT, PPICLF_LINTP, PPICLF_LPROJ
     > ,PPICLF_LSUBBIN, PPICLF_LSUBSUBBIN
     > ,PPICLF_LFILTGAUSS, PPICLF_LFILTBOX, PPICLF_SNGL_ELEM
      COMMON /PPICLF_OPT_PARAM_L/ PPICLF_RESTART, PPICLF_OVERLAP
     > ,PPICLF_LCOMM, PPICLF_LINIT
     > ,PPICLF_LFILT, PPICLF_LINTP
     > ,PPICLF_LPROJ, PPICLF_LSUBBIN
     > ,PPICLF_LSUBSUBBIN
     > ,PPICLF_LFILTGAUSS, PPICLF_LFILTBOX
     > ,PPICLF_SNGL_ELEM
      DATA PPICLF_LCOMM /.false./
      DATA PPICLF_RESTART /.false./
      INTEGER*4 PPICLF_NDIM, PPICLF_IMETHOD, PPICLF_IPERIODIC(3)
     > ,PPICLF_NGRIDS, PPICLF_CYCLE, PPICLF_IOSTEP
     > ,PPICLF_IENDIAN, PPICLF_IWALLM
      COMMON /PPICLF_OPT_PARAM_I/ PPICLF_NDIM, PPICLF_IMETHOD
     > ,PPICLF_IPERIODIC, PPICLF_NGRIDS
     > ,PPICLF_CYCLE, PPICLF_IOSTEP
     > ,PPICLF_IENDIAN, PPICLF_IWALLM
      REAL*8 PPICLF_FILTER, PPICLF_ALPHA, PPICLF_RK3COEF(3,3), PPICLF_DT
     > ,PPICLF_TIME, PPICLF_D2CHK(3)
      REAL*8 PPICLF_RK3ARK(3)
      COMMON /PPICLF_OPT_PARAM_R/ PPICLF_FILTER, PPICLF_ALPHA
     > ,PPICLF_RK3COEF, PPICLF_DT
     > ,PPICLF_TIME, PPICLF_D2CHK
     > ,PPICLF_RK3ARK
! number of timesteps kept in history kernels
! maximum number of triangular patch boundaries
! y, y1, ydot, ydotc: 12
! rprop: 54
! probably delete below ones later; using them for plotting
! rprop4: PPICLF_LRP4 - Reynolds Subgrid Stress Components
! rprop5: PPICLF_LRP5 - Storing Force Models
! map: 19
!--- x,y,z Forces to Rocflu
!---
!--- Add comment about these terms
!--- Reynolds Subgrid Stress Tensor
c Communication
      COMMON /PPICLF_PARALLEL_COMM_I/ PPICLF_COMM, PPICLF_NP, PPICLF_NID
     > ,PPICLF_CR_HNDL, PPICLF_FP_HNDL
     > ,PPICLF_COMM_NID
      INTEGER*4 PPICLF_COMM, PPICLF_NP, PPICLF_NID, PPICLF_CR_HNDL
     > ,PPICLF_FP_HNDL, PPICLF_COMM_NID
      DATA PPICLF_NID /0/
c Bins
      INTEGER*4 PPICLF_N_BINS(3)
      COMMON /PPICLF_PARALLEL_BIN_GLOBAL_N/ PPICLF_N_BINS
      REAL*8 PPICLF_BINS_DX(3), PPICLF_BINB(6)
      COMMON /PPICLF_PARALLEL_BIN_GLOBAL_R/ PPICLF_BINS_DX, PPICLF_BINB
      REAL*8 PPICLF_BINX(2,1), PPICLF_BINY(2,1)
     > ,PPICLF_BINZ(2,1), PPICLF_RDX, PPICLF_RDY
     > ,PPICLF_RDZ
      REAL*4 PPICLF_GRID_X(1,1,1)
     > ,PPICLF_GRID_Y(1,1,1)
     > ,PPICLF_GRID_Z(1,1,1)
     > ,PPICLF_GRID_FLD(1,1,1,19)
      COMMON /PPICLF_PARALLEL_BIN_LOCAL_R/ PPICLF_BINX, PPICLF_BINY
     > ,PPICLF_BINZ, PPICLF_RDX
     > ,PPICLF_RDY, PPICLF_RDZ
     > ,PPICLF_GRID_X,PPICLF_GRID_Y
     > ,PPICLF_GRID_Z,PPICLF_GRID_FLD
      INTEGER*4 PPICLF_GRID_I (1, 1, 1)
      COMMON /PPICLF_PARALLEL_BIN_LOCAL_I/ PPICLF_GRID_I
      INTEGER*4 PPICLF_BX, PPICLF_BY, PPICLF_BZ
      COMMON /PPICLF_PARALLEL_BIN_LOCAL_N/ PPICLF_BX, PPICLF_BY
     > ,PPICLF_BZ
C Ghost particles
      REAL*8 PPICLF_RPROP_GP(12 +54 +19,26*20000)
     > ,PPICLF_CP_MAP(12 +54 +19,20000)
      COMMON /PPICLF_PARALLEL_GHOST_R/ PPICLF_RPROP_GP, PPICLF_CP_MAP
      INTEGER*4 PPICLF_NB_R(3,20000)
     > ,PPICLF_NB_G(3,26*20000)
      COMMON /PPICLF_PARALLEL_NEIGHBOR_I/ PPICLF_NB_R, PPICLF_NB_G
      INTEGER*4 PPICLF_IPROP_GP(5,26*20000)
      COMMON /PPICLF_PARALLEL_GHOST_I/ PPICLF_IPROP_GP
      INTEGER*4 PPICLF_NPART_GP
      COMMON /PPICLF_PARALLEL_GHOST_N/ PPICLF_NPART_GP
! number of timesteps kept in history kernels
! maximum number of triangular patch boundaries
! y, y1, ydot, ydotc: 12
! rprop: 54
! probably delete below ones later; using them for plotting
! rprop4: PPICLF_LRP4 - Reynolds Subgrid Stress Components
! rprop5: PPICLF_LRP5 - Storing Force Models
! map: 19
!--- x,y,z Forces to Rocflu
!---
!--- Add comment about these terms
!--- Reynolds Subgrid Stress Tensor
!
! General useage
!
      integer*4 :: stationary, qs_flag, am_flag, pg_flag,
     > collisional_flag, heattransfer_flag, feedback_flag,
     > qs_fluct_flag, ppiclf_debug, rmu_flag,
     > rmu_fixed_param, rmu_suth_param, qs_fluct_filter_flag,
     > qs_fluct_filter_adapt_flag,
     > ViscousUnsteady_flag, ppiclf_nUnsteadyData,ppiclf_nTimeBH,
     > sbNearest_flag, burnrate_flag, flow_model, pseudoTurb_flag
      real*8 :: rmu_ref, tref, suth, ksp, erest
      common /RFLU_ppiclF/ stationary, qs_flag, am_flag, pg_flag,
     > collisional_flag, heattransfer_flag, feedback_flag,
     > qs_fluct_flag, ppiclf_debug, rmu_flag, rmu_ref, tref, suth,
     > rmu_fixed_param, rmu_suth_param, qs_fluct_filter_flag,
     > qs_fluct_filter_adapt_flag, ksp, erest,
     > ViscousUnsteady_flag, ppiclf_nUnsteadyData,ppiclf_nTimeBH,
     > sbNearest_flag, burnrate_flag, flow_model, pseudoTurb_flag
      real*8 rpi,rmu,rkappa,rmass,vmag,rhof,dp,rep,rphip,
     > rphif,asndf,rmachp,rhop,rhoMixt,reyL,rnu,fac,
     > vx,vy,vz,
     > rcp_part,rpr,
     > phi, mp, re, rem
      common /RFLU_user/ rpi,rmu,rkappa,rmass,vmag,rhof,dp,rep,rphip,
     > rphif,asndf,rmachp,rhop,rhoMixt,reyL,rnu,fac,
     > vx,vy,vz,
     > rcp_part,rpr,
     > phi,mp,re,rem
!
! For misc values
!
      real*8 OneThird
      common /ppiclf_misc01/ OneThird
!
! For ppiclf_user_Fluctuations.f
!
      integer*4 icpmean
      real*8 upmean, vpmean, wpmean, phipmean
      real*8 u2pmean, v2pmean, w2pmean
      common /user_fluct01/ icpmean
      common /user_fluct02/ upmean, vpmean, wpmean, phipmean
      common /user_fluct03/ u2pmean, v2pmean, w2pmean
      real*8 UnifRnd(6), Rsg(3,3)
      common /user_fluct02/ UnifRnd, Rsg
      real*8 k_tilde, k_Mach, b_tilde,
     > b_Mach, b_par, b_perp,
     > Rmean_par, Rmean_perp
      common /user_fluct03/ k_tilde, k_Mach,
     > b_Mach, b_par, b_perp,
     > Rmean_par, Rmean_perp
      real*8 C1P, C2P, C3P, C4P, C5P,
     > D1P, D2P, D3P, D4P, D5P, D6P, D7P, D8P,
     > E1P, E2P, E3P, E4P
      real*8 F1P, F2P, F3P, F4P, F5P, F6P, F7p, F8P, F9P, F10P, F11P,
     > G1P, G2P, G3P, G4P, G5P, G6P, G7P, G8P,
     > A1P, A2P, A3P
      ! Constants taken from Osnes PseudoTurbulent paper, Table 1
      parameter C1P = -1.2152, C2P = -7.6314, C3P=0.2889, C4P=0.6143,
     > C5P = 0.3082,
     > D1P = -0.0462, D2P = -0.1068, D3P=0.6793, D4P=1.1461,
     > D5P = -2.6886, D6P = -2.1376, D7P=0.4873, D8P=0.2395,
     > E1P = -0.2906, E2P=1.1899, E3P=0.5218, E4P=0.0699
      ! Constants taken from Osnes PseudoTurbulent paper, Table 2
      parameter F1P= -0.0022, F2P= -0.0219, F3P=0.0932, F4P= -0.0135,
     > F5P=0.0361, F6P=0.0403, F7P= -0.0761, F8P = 0.0599,
     > F9P=0.0164, F10P=0.0453, F11P= -0.0265,
     > G1P= -0.2867, G2P=0.2176, G3P=0.2826, G4P=-0.0644,
     > G5P=0.0466, G6P=0.0973, G7P= -0.0081, G8P=-0.0235
      ! Variables for averaging mean flow quantities
      real*8 cd_average, v2magmean
      common /user_fluct04/ cd_average, v2magmean
!
! For ppiclf_user_debug.f
!
      real*8 phimax,
     > fqsx_max,fqsy_max,fqsz_max,
     > famx_max,famy_max,famz_max,
     > fdpdx_max,fdpdy_max,fdpdz_max,
     > fcx_max,fcy_max,fcz_max,
     > umean_max,vmean_max,wmean_max,
     > fqs_mag,fam_mag,fdp_mag,fc_mag,
     > fqsx_fluct_max,fqsy_fluct_max,fqsz_fluct_max,
     > fqsx_total_max,fqsy_total_max,fqsz_total_max,
     > fvux_max,fvuy_max,fvuz_max,
     > qq_max,tau_max,lift_max
      common /user_debug/ phimax,
     > fqsx_max,fqsy_max,fqsz_max,
     > famx_max,famy_max,famz_max,
     > fdpdx_max,fdpdy_max,fdpdz_max,
     > fcx_max,fcy_max,fcz_max,
     > umean_max,vmean_max,wmean_max,
     > fqs_mag,fam_mag,fdp_mag,fc_mag,
     > fqsx_fluct_max,fqsy_fluct_max,fqsz_fluct_max,
     > fqsx_total_max,fqsy_total_max,fqsz_total_max,
     > fvux_max,fvuy_max,fvuz_max,
     > qq_max,tau_max,lift_max
!
! For ppiclf_user_AddedMass.f
!
      integer*4 nneighbors
      real*8 Fam(3), FamUnary(3), FamBinary(3),
     > Wdot_neighbor_mean(3), R_pair(6,6)
      common /user_AddedMass01/ nneighbors
      common /user_AddedMass02/ Fam, FamUnary, FamBinary,
     > Wdot_neighbor_mean, R_pair
!
! For ppiclf_solve_InitAngularPeriodic
!
      integer*4 x_per_flag, y_per_flag, z_per_flag, ang_per_flag,
     > ang_case
      real*8 ang_per_angle, ang_per_xangle,
     > ang_per_rin, ang_per_rout,
     > xrot(3) , vrot(3)
      real*8 x_per_min, x_per_max,
     > y_per_min, y_per_max, z_per_min, z_per_max
      common /solve_InitAngularPeriodic01/ x_per_flag, y_per_flag,
     > z_per_flag, ang_per_flag,
     > ang_case
      common /solve_InitAngularPeriodic02/ ang_per_angle,
     > ang_per_xangle,
     > ang_per_rin,
     > ang_per_rout,
     > xrot, vrot
      common /solve_InitAngularPeriodic03/ x_per_min, x_per_max,
     > y_per_min, y_per_max, z_per_min, z_per_max
! number of timesteps kept in history kernels
! maximum number of triangular patch boundaries
! y, y1, ydot, ydotc: 12
! rprop: 54
! probably delete below ones later; using them for plotting
! rprop4: PPICLF_LRP4 - Reynolds Subgrid Stress Components
! rprop5: PPICLF_LRP5 - Storing Force Models
! map: 19
!--- x,y,z Forces to Rocflu
!---
!--- Add comment about these terms
!--- Reynolds Subgrid Stress Tensor
C Wall support
      REAL*8 PPICLF_WALL_C(9,20),PPICLF_WALL_N(4,20)
      COMMON /PPICLF_WALL_R/ PPICLF_WALL_C,PPICLF_WALL_N
      INTEGER*4 PPICLF_NWALL
      COMMON /PPICLF_WALL_N/ PPICLF_NWALL
C Mirror wall particles
      REAL*8 PPICLF_XYZ_MIRROR(3,20)
      COMMON /PPICLF_WALL_MIRROR_R/ PPICLF_XYZ_MIRROR
      INTEGER*4 PPICLF_NWALL_M
      COMMON /PPICLF_WALL_MIRROR_N/ PPICLF_NWALL_M
